!function([t]){const s={r(){},d(t,s,n){t[s]=n}},n={};t.call(n,null,n,s);for(const t in n)n[t]=n[t]()}([function(t,s,n){"use strict";n.r(s);const i=11;function e(t,s){const{firstChild:n,lastChild:e}=function(t){return t.nodeType===i?t:{firstChild:t,lastChild:t}}(s);(n.lemnRef=t.i=n.lemnRef||t.i).t=n,(e.lemnEndRef=t.s=e.lemnEndRef||t.s).t=e}function o(t){const s=document.createRange();return s.setStartBefore(t.i.t),s.setEndAfter(t.s.t),s.extractContents(),s}function c(t,s){const n=o(t);e(t,s),n.insertNode(s)}function r({o:{t,h:s}},n){t.removeAttribute(s),Array.isArray(n)?t[s]=n.join(" "):"object"==typeof n?Object.assign(t[s],n):t[s]=n}function h(t){return t.some(Array.isArray)?h([].concat(...t)):t}const u="lemn";function d(t,...s){const n=[t[0],...h(s.map((s,n)=>[s,t[n+1]]))];let i;return Object.defineProperty(n,"content",{get(){if(!i){const t=n.map((t,s)=>"object"==typeof t||"function"==typeof t?`<link class=${u}${s}>`:t).join("")||" ";i=document.createRange().createContextualFragment(t)}const t=i.cloneNode(!0);return n.forEach((s,n)=>{if("object"==typeof s||"function"==typeof s){const i=t.querySelector(`.${u}${n}`);i?s.nodeType?c({i:{t:i},s:{t:i}},s):(s.lemnRef={...s.lemnRef,i:{t:i},s:{t:i}},t.u=[...t.u||[],s]):Array.from(t.querySelectorAll("*")).some(i=>Array.from(i.attributes).some(e=>{if(e.value===`<link class=${u}${n}>`){const n="class"===e.name?"className":e.name;return s.render?(s.lemnRef={o:{t:i,h:n}},t.u=[...t.u||[],s]):r({o:{t:i,h:n}},s),!0}}))}}),t}}),n}function l(t){return t.nodeType?t:d`${t}`.content}function a(t,s){t&&t.call(s)}function f(t){a(t.willDetach,t)}function m(t){a(t.didAttach,t)}function p(t){if(a(t.willRender,t),t.lemnRef.o)r(t.lemnRef,t.render()||"");else{const s=l(t.render()||" ");(t.lemnRef.u||[]).forEach(t=>!(s.u||[]).includes(t)&&f(t)),(s.u||[]).forEach(t=>p(t)),(s.u||[]).forEach(s=>!(t.lemnRef.u||[]).includes(s)&&m(s)),t.lemnRef.u=s.u||[],c(t.lemnRef,s)}a(t.didRender,t)}class ${constructor(t,s){this.parent=t,this.l=s,this.data=this.l(this.parent.data,this.data)}unbind(t){0===(this.m=(this.m||[]).filter(s=>s!==t)).length&&this.parent.unbind(this)}bind(t){1===(this.m=[...this.m||[],t]).length&&(this.parent.bind(this),this.data=this.l(this.parent.data,this.data))}push(){var t;this.data!==(this.data=this.l(this.parent.data,this.data))&&((this.m||[]).forEach(t=>t.push()),this.lemnRef&&(t=this,Promise.resolve(t).then(p)))}as(t){return new $(this,t)}willDetach(){this.parent.unbind(this)}didAttach(){this.parent.bind(this)}render(){return this.data}}class b extends ${constructor(t={}){super({bind(){},unbind(){},data:t},t=>t)}set(t){this.parent.data=t,this.push()}toJSON(){return this.data}}const y=new class{constructor(t={}){Object.entries(t).forEach(t=>this.set(...t))}model(t){return(this.v=this.v||{})[t]=this.v[t]||new b}get(t){return((this.v=this.v||{})[t]=this.v[t]||new b).data}set(t,s){((this.v=this.v||{})[t]=this.v[t]||new b).set(s)}remove(t){delete this.v[t]}toJSON(){return this.v}}({"todos/index":[]});class w{constructor(t){this.id=t,this.model=y.model(t)}render(){const{model:t}=this;return d`<div>
    <input type="checkbox"
      checked="${t.as(({complete:t})=>t)}"
      onchange="${s=>t.set({...t.data,complete:!t.data.complete})}">
      ${t.data.description}
    </div>`}}class x{constructor(t){this.id=t,this.index=y.model(t)}render(){return d`${this.index.as(t=>t.map(t=>new w(t)))}`}}class k{constructor(t={name:"name",model:new b("")}){this.options=t}render(){const{name:t,model:s}=this.options;return d`<input type="text"
      name="${t}"
      value="${s.as(t=>t)}"
      onkeyup="${t=>s.set(t.currentTarget.value)}">`}}class v{constructor(){this.nextId=0,this.submit=this.submit.bind(this),this.descriptionModel=new b("")}submit(t){const s=this.nextId++;return y.set(`todos/${s}`,{complete:!1,description:this.descriptionModel.data}),this.descriptionModel.set(""),y.set("todos/index",[...y.get("todos/index")||[],`todos/${s}`]),t.preventDefault(),!1}render(){return d`<form onsubmit="${this.submit}">
      ${new k({name:"description",model:this.descriptionModel})}
      <input type="button" value="add" onclick="${this.submit}">
    </form>`}}!function(t,s){t.appendChild(l(s)),p(s),m(s)}(document.querySelector(".root"),new class{render(){const t=y.model("todos/index");return d`
      <section class="container" style="margin-top: 2em">
      <input type="button" value="clear complete" onclick="${()=>t.set(t.data.filter(t=>!y.get(t).complete))}">
      ${new v}
      ${new x("todos/index")}
      </section>
    `}})}]);
//# sourceMappingURL=todo.js.map