Object.defineProperty(exports,"__esModule",{value:!0});const t=11;function i(i,e){const{firstChild:s,lastChild:n}=function(i){return i.nodeType===t?i:{firstChild:i,lastChild:i}}(e);(s.lemnRef=i.i=s.lemnRef||i.i).t=s,(n.lemnEndRef=i.s=n.lemnEndRef||i.s).t=n}function e(t){const i=document.createRange();return i.setStartBefore(t.i.t),i.setEndAfter(t.s.t),i.extractContents(),i}function s(t,s){const n=e(t);i(t,s),n.insertNode(s)}function n({o:{t,h:i}},e){t.removeAttribute(i),Array.isArray(e)?t[i]=e.join(" "):"object"==typeof e?Object.assign(t[i],e):t[i]=e}function r(t){return t.some(Array.isArray)?r([].concat(...t)):t}const o="lemn";function h(t,...i){const e=[t[0],...r(i.map((i,e)=>[i,t[e+1]]))],h=e.map((t,i)=>"object"==typeof t||"function"==typeof t?`<link class=${o}${i}>`:t).join("")||" ",c=document.createRange().createContextualFragment(h);return e.forEach((t,i)=>{if("object"==typeof t||"function"==typeof t){const e=c.querySelector(`.${o}${i}`);e?t.nodeType?s({i:{t:e},s:{t:e}},t):(t.lemnRef={...t.lemnRef,i:{t:e},s:{t:e}},c.l=[...c.l||[],t]):Array.from(c.querySelectorAll("*")).some(e=>Array.from(e.attributes).some(s=>{if(s.value===`<link class=${o}${i}>`){const i="class"===s.name?"className":s.name;return t.render?(t.lemnRef={o:{t:e,h:i}},c.l=[...c.l||[],t]):n({o:{t:e,h:i}},t),!0}}))}}),c}function c(t,i){t&&t.call(i)}function a(t){c(t.willDetach,t)}function l(t){c(t.didAttach,t)}function u(t){if(c(t.willRender,t),t.lemnRef.o)n(t.lemnRef,t.render()||"");else{const e=(i=t.render()||" ").nodeType?i:h`${i}`;e.lemnRef||((t.lemnRef.l||[]).forEach(t=>!(e.l||[]).includes(t)&&a(t)),(e.l||[]).forEach(t=>u(t)),(e.l||[]).forEach(i=>!(t.lemnRef.l||[]).includes(i)&&l(i)),t.lemnRef.l=e.l||[],s(t.lemnRef,e),e.lemnRef=t.lemnRef)}var i;c(t.didRender,t)}function m(t){return Promise.resolve(t).then(u)}class f{constructor(t,i){this.parent=t,this.u=i,this.data=this.u(this.parent.data,this.data)}unbind(t){0===(this.m=(this.m||[]).filter(i=>i!==t)).length&&this.parent.unbind(this)}bind(t){1===(this.m=[...this.m||[],t]).length&&(this.parent.bind(this),this.data=this.u(this.parent.data,this.data))}push(){this.data!==(this.data=this.u(this.parent.data,this.data))&&((this.m||[]).forEach(t=>t.push()),this.lemnRef&&m(this))}as(t){return new f(this,t)}willDetach(){this.parent.unbind(this)}didAttach(){this.parent.bind(this)}render(){return this.data}}class d extends f{constructor(t={}){super({bind(){},unbind(){},data:t},t=>t)}set(t){this.parent.data=t,this.push()}toJSON(){return this.data}}exports.h=h,exports.attach=function(t,i){t.appendChild(h`${i}`),u(i),l(i)},exports.detach=function(t){a(t),e(t.lemnRef)},exports.rerender=m,exports.Bond=f,exports.Model=d,exports.Store=class{constructor(t={}){Object.entries(t).forEach(t=>this.set(...t))}model(t){return(this.v=this.v||{})[t]=this.v[t]||new d}get(t){return((this.v=this.v||{})[t]=this.v[t]||new d).data}set(t,i){((this.v=this.v||{})[t]=this.v[t]||new d).set(i)}remove(t){delete this.v[t]}toJSON(){return this.v}};
//# sourceMappingURL=index.cjs.min.js.map