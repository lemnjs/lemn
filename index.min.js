const t=11;function i(i,n){const{firstChild:e,lastChild:s}=function(i){return i.nodeType===t?i:{firstChild:i,lastChild:i}}(n);(e.lemnRef=i.i=e.lemnRef||i.i).t=e,(s.lemnEndRef=i.s=s.lemnEndRef||i.s).t=s}function n(t){const i=document.createRange();return i.setStartBefore(t.i.t),i.setEndAfter(t.s.t),i.extractContents(),i}function e(t,e){const s=n(t);i(t,e),s.insertNode(e)}function s({h:{t,o:i}},n){t.removeAttribute(i),Array.isArray(n)?t[i]=n.join(" "):"object"==typeof n?Object.assign(t[i],n):t[i]=n}function r(t){return t.some(Array.isArray)?r([].concat(...t)):t}const h="lemn";function o(t,...i){const n=[t[0],...r(i.map((i,n)=>[i,t[n+1]]))],o=n.map((t,i)=>"object"==typeof t||"function"==typeof t?`<link class=${h}${i}>`:t).join("")||" ",c=document.createRange().createContextualFragment(o);return n.forEach((t,i)=>{if("object"==typeof t||"function"==typeof t){const n=c.querySelector(`.${h}${i}`);n?t.nodeType?e({i:{t:n},s:{t:n}},t):(t.lemnRef={...t.lemnRef,i:{t:n},s:{t:n}},c.l=[...c.l||[],t]):Array.from(c.querySelectorAll("*")).some(n=>Array.from(n.attributes).some(e=>{if(e.value===`<link class=${h}${i}>`){const i="class"===e.name?"className":e.name;return t.render?(t.lemnRef={h:{t:n,o:i}},c.l=[...c.l||[],t]):s({h:{t:n,o:i}},t),!0}}))}}),c}function c(t,i){t&&t.call(i)}function a(t){c(t.willDetach,t)}function l(t){c(t.didAttach,t)}function u(t){if(c(t.willRender,t),t.lemnRef.h)s(t.lemnRef,t.render()||"");else{const n=(i=t.render()||" ").nodeType?i:o`${i}`;n.lemnRef||((t.lemnRef.l||[]).forEach(t=>!(n.l||[]).includes(t)&&a(t)),(n.l||[]).forEach(t=>u(t)),(n.l||[]).forEach(i=>!(t.lemnRef.l||[]).includes(i)&&l(i)),t.lemnRef.l=n.l||[],e(t.lemnRef,n),n.lemnRef=t.lemnRef)}var i;c(t.didRender,t)}function m(t){return Promise.resolve(t).then(u)}function f(t,i){t.appendChild(o`${i}`),u(i),l(i)}function d(t){a(t),n(t.lemnRef)}class v{constructor(t,i){this.parent=t,this.u=i,this.data=this.u(this.parent.data,this.data)}unbind(t){0===(this.m=(this.m||[]).filter(i=>i!==t)).length&&this.parent.unbind(this)}bind(t){1===(this.m=[...this.m||[],t]).length&&(this.parent.bind(this),this.data=this.u(this.parent.data,this.data))}push(){this.data!==(this.data=this.u(this.parent.data,this.data))&&((this.m||[]).forEach(t=>t.push()),this.lemnRef&&m(this))}as(t){return new v(this,t)}willDetach(){this.parent.unbind(this)}didAttach(){this.parent.bind(this)}render(){return this.data}}class P extends v{constructor(t={}){super({bind(){},unbind(){},data:t},t=>t)}set(t){this.parent.data=t,this.push()}toJSON(){return this.data}}class b{constructor(t={}){Object.entries(t).forEach(t=>this.set(...t))}model(t){return(this.v=this.v||{})[t]=this.v[t]||new P}get(t){return((this.v=this.v||{})[t]=this.v[t]||new P).data}set(t,i){((this.v=this.v||{})[t]=this.v[t]||new P).set(i)}remove(t){delete this.v[t]}toJSON(){return this.v}}export{o as h,f as attach,d as detach,m as rerender,v as Bond,P as Model,b as Store};